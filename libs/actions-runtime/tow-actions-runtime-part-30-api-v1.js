// Auto-generated by macros/tools/build-actions-runtime-libs.mjs
// Registers actions runtime source part: 30-api
(() => {
  const bundle = game["towActionsRuntimeBundleV1"] ?? (game["towActionsRuntimeBundleV1"] = {
    version: "1.0.0",
    parts: new Map(),
    order: ["00-core","10-attack-flow","20-defence-flow","30-api"]
  });
  bundle.version = "1.0.0";
  if (!(bundle.parts instanceof Map)) bundle.parts = new Map();
  bundle.parts.set("30-api", "async function attackActor(actor, { manual = false } = {}) {\n  if (!actor) return;\n  if (!shouldExecuteAttack(actor, { manual })) return;\n  const attacks = getSortedWeaponAttacks(actor);\n  if (attacks.length === 0) return;\n\n  if (manual) {\n    renderAttackSelector(actor, attacks);\n    return;\n  }\n  await setupAbilityTestWithDamage(actor, attacks[0], { autoRoll: true });\n}\n\nasync function defenceActor(actor, { manual = false } = {}) {\n  if (!actor) return;\n  const skills = getActorSkills(actor);\n  const manualEntries = getManualDefenceEntries(actor);\n  if (manualEntries.length === 0) {\n    ui.notifications.warn(`${actor.name}: no rollable skills or characteristics found.`);\n    return;\n  }\n\n  if (manual) {\n    renderDefenceSelector(actor, manualEntries);\n    return;\n  }\n\n  if (skills.length === 0) {\n    ui.notifications.warn(`${actor.name}: no rollable skills found for default defence roll.`);\n    return;\n  }\n\n  const skillToRoll = skills.includes(DEFAULT_DEFENCE_SKILL) ? DEFAULT_DEFENCE_SKILL : skills[0];\n  if (skillToRoll !== DEFAULT_DEFENCE_SKILL) {\n    ui.notifications.warn(`${actor.name}: '${DEFAULT_DEFENCE_SKILL}' not found, rolled '${skillToRoll}' instead.`);\n  }\n  await rollSkill(actor, skillToRoll, { autoRoll: true });\n}\n\nasync function runAttackForControlled({ manual = false } = {}) {\n  const tokens = canvas.tokens.controlled;\n  if (!tokens.length) {\n    ui.notifications.warn(\"Select at least one token.\");\n    return;\n  }\n  for (const token of tokens) {\n    await attackActor(token.actor, { manual });\n  }\n}\n\nasync function runDefenceForControlled({ manual = false } = {}) {\n  const tokens = canvas.tokens.controlled;\n  if (!tokens.length) {\n    ui.notifications.warn(\"Select at least one token.\");\n    return;\n  }\n  for (const token of tokens) {\n    await defenceActor(token.actor, { manual });\n  }\n}\n\ngame[TOW_ACTIONS_KEY] = {\n  version: TOW_ACTIONS_VERSION,\n  isShiftHeld,\n  escapeHtml,\n  toElement,\n  scheduleSoon,\n  attackActor,\n  defenceActor,\n  runAttackForControlled,\n  runDefenceForControlled\n};\n\nui.notifications.info(\"TOW shared actions loaded.\");\n");
})();
